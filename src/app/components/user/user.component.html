<div class="content boxshadow" dpfContent>
    <h2>Users <i class="fa icon-plus-1 new" (click)="showNew()">Add new</i></h2>
    <div class="dpfoverflowwrapper" dpfOverflowWrapper>
      <div class="spacer20"></div>
      <table>
        <tr>
          <td>
            <i class="fa icon-search"></i><input placeholder="name" (ngModelChange)="filter.name=$event;filterChanges();" (click)="$event.stopPropagation()" [(ngModel)]="filter.name" class="filter" type="text"  name="nameFilter" >
          </td>
          <td>
            <i class="fa icon-search"></i><input placeholder="surname" (ngModelChange)="filter.surname=$event;filterChanges();" (click)="$event.stopPropagation()" [(ngModel)]="filter.surname" class="filter" type="text"  name="surnameFilter" >
          </td>
          <td>
            <i class="fa icon-search"></i><input placeholder="city" (ngModelChange)="filter.city=$event;filterChanges();" (click)="$event.stopPropagation()" [(ngModel)]="filter.city" class="filter" type="text"  name="cityFilter" >
          </td>
          <td>
            <i class="fa icon-search"></i><input placeholder="country" (ngModelChange)="filter.country=$event;filterChanges();" (click)="$event.stopPropagation()" [(ngModel)]="filter.country" class="filter" type="text"  name="countryFilter" >
          </td>
          <td>
            <i class="fa icon-search"></i><input placeholder="department" (ngModelChange)="filter.department=$event;filterChanges();" (click)="$event.stopPropagation()" [(ngModel)]="filter.department" class="filter" type="text"  name="departmentFilter" >
          </td>
          <td>
            <i class="fa icon-search"></i><input placeholder="mail" (ngModelChange)="filter.mail=$event;filterChanges();" (click)="$event.stopPropagation()" [(ngModel)]="filter.mail" class="filter" type="text"  name="mailFilter" >
          </td>
          <td>
            <i class="fa icon-search"></i><input placeholder="usertype" (ngModelChange)="filter.usertype=$event;filterChanges();" (click)="$event.stopPropagation()" [(ngModel)]="filter.usertype" class="filter" type="text"  name="usertypeFilter" >
          </td>
        </tr>
      </table>

        <table mat-table matSort [dataSource]="dataSource" >
          <ng-container matColumnDef="name">
              <th mat-sort-header mat-header-cell *matHeaderCellDef>
                Name
              </th>
            <td mat-cell *matCellDef="let user"> {{user.name}} </td>
          </ng-container>
          <ng-container matColumnDef="surname">
            <th mat-sort-header mat-header-cell *matHeaderCellDef>
              Surname
            </th>
            <td mat-cell *matCellDef="let user"> {{user.surname}} </td>
          </ng-container>
          <ng-container matColumnDef="city">
            <th mat-sort-header mat-header-cell *matHeaderCellDef>
              City
            </th>
            <td mat-cell *matCellDef="let user"> {{user.city}} </td>
          </ng-container>

          <ng-container matColumnDef="country">
            <th mat-sort-header mat-header-cell *matHeaderCellDef>
              Country
            </th>
            <td mat-cell *matCellDef="let user"> {{user.country}} </td>
          </ng-container>
          <ng-container matColumnDef="department">
            <th mat-sort-header mat-header-cell *matHeaderCellDef>
              Department
            </th>
            <td mat-cell *matCellDef="let user"> {{user.department}} </td>
          </ng-container>
          <ng-container matColumnDef="costno">
            <th mat-sort-header mat-header-cell *matHeaderCellDef>
              Cost No.
            </th>
            <td mat-cell *matCellDef="let user"> {{user.costno}} </td>
          </ng-container>
          <ng-container matColumnDef="mail">
            <th mat-sort-header mat-header-cell *matHeaderCellDef>
              Email
            </th>
            <td mat-cell *matCellDef="let user"> {{user.mail}} </td>
          </ng-container>
          <ng-container matColumnDef="usertype">
            <th mat-sort-header mat-header-cell *matHeaderCellDef>
              Usertype
            </th>
            <td mat-cell *matCellDef="let user"> {{user.usertype}} </td>
          </ng-container>

          <ng-container matColumnDef="deleted">
            <th mat-sort-header mat-header-cell *matHeaderCellDef>
              Hidden
            </th>
            <td mat-cell *matCellDef="let user"> {{user.deleted}} </td>
          </ng-container>

          <ng-container matColumnDef="edit">
            <th mat-sort-header mat-header-cell *matHeaderCellDef>
              Edit
            </th>
            <td class="edit" (click)="ui.doShowEditNew();setCurrentDataSet(part);" mat-cell *matCellDef="let part"> <i class="fa icon-edit edit"></i> </td>
          </ng-container>

          <ng-container matColumnDef="delete">
            <th mat-header-cell *matHeaderCellDef>
              Delete
            </th>
            <td class="edit" (click)="showDelete(part)" mat-cell *matCellDef="let part"> <i class="fa icon-trash-empty delete"></i> </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="columnsToDisplay; sticky: true"></tr>
          <tr mat-row *matRowDef="let part; columns: columnsToDisplay"></tr>
        </table>
      </div>
  </div>
  <div class="overlaybg" *ngIf="ui.showOverlay"></div>
  <div class="overlay" *ngIf="ui.showEditNew">
    <div class="overlay-content">
      <span (click)="currentDataSet = null;ui.doCloseEditNew()" class="close"><i class="fa icon-cancel"></i></span>
      <h3 class="fa icon-edit">User</h3>
      <p>{{currentDataSet.name}}</p>
      <hr />
      <div class="container-flex">
        <form name="userForm" [formGroup]="userForm">
          <div class="spacer20"></div>
          <mat-form-field>
            <input type="text" formControlName="name" matInput name="name" #name placeholder="Name*">
            <mat-error [hidden]="name.valid || name.pristine">required</mat-error>
          </mat-form-field>
          <mat-form-field>
            <input type="text" formControlName="surname" matInput name="surname" #surname placeholder="Surname">
            <mat-error [hidden]="name.valid || surname.pristine">required</mat-error>
          </mat-form-field>
          <mat-form-field>
            <input type="text" formControlName="city" matInput name="city" #city placeholder="City">
            <mat-error [hidden]="department.valid || department.pristine">required</mat-error>
          </mat-form-field>
          <mat-form-field>
            <input type="text" formControlName="country" matInput name="country" #country placeholder="Country">
            <mat-error [hidden]="country.valid || country.pristine">required</mat-error>
          </mat-form-field>
          <mat-form-field>
            <input type="text" formControlName="department" matInput name="department" #department placeholder="Department">
            <mat-error [hidden]="country.valid || country.pristine">required</mat-error>
          </mat-form-field>
          <mat-form-field>
            <input type="text" formControlName="mail" matInput name="mail" #mail placeholder="E-Mail*">
            <mat-error [hidden]="mail.valid || mail.pristine">required</mat-error>
          </mat-form-field>
          <mat-form-field>
            <input type="text" formControlName="phone" matInput name="phone" #phone placeholder="Phone">
            <mat-error [hidden]="phone.valid || phone.pristine">required</mat-error>
          </mat-form-field>
          <mat-form-field>
            <input type="text" formControlName="fax" matInput name="fax" #fax placeholder="Fax">
            <mat-error [hidden]="fax.valid || fax.pristine">required</mat-error>
          </mat-form-field>

          <button *ngIf="currentDataSet" mat-raised-button (click)="sendPassword();">Send new password</button>
          <hr />
          <div class="spacer20"></div>
          <button (click)="save()" mat-raised-button>Save</button>
          <div class="spacer20"></div>
          <div *ngIf="ui.saveSuccess">
            <div class="spacer20"></div>
            Save Success
          </div>
        </form>
      </div>
    </div>
  </div>

  <div class="overlay" *ngIf="ui.showDelete">
    <div class="overlay-content">
      <span (click)="deleteClose()" class="close"><i class="fa icon-cancel">X</i></span>
      <h3 class="fa icon-trash-empty">User</h3>
      <p>{{dataSetToDelete.name}}</p>
      <hr />
      <div class="container-flex">
        <h2>This User will be deleted permanently. Are you sure?</h2>
        <div class="spacer"></div>
        <div style="display:flex;justify-content:  space-between" *ngIf="!ui.deleteSuccess">
          <button class="delete-button" (click)="delete()" mat-raised-button>Delete</button>
          <button class="abort-button" (click)="dataSetToDelete = null;ui.showOverlay = false;" mat-raised-button>Abort</button>
        </div>
        <div *ngIf="ui.deleteSuccess">
          Delete Success
        </div>
      </div>
    </div>
  </div>
